<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>7 Exercises | Annual Summer Course in Flux Measurements and Modelling</title>
  <meta name="description" content="Fluxcourse Book">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="7 Exercises | Annual Summer Course in Flux Measurements and Modelling" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://http://fluxcourse.github.io/Fluxcourse-Book" />
  
  <meta property="og:description" content="Fluxcourse Book" />
  <meta name="github-repo" content="Fluxcourse/Fluxcourse-Book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Exercises | Annual Summer Course in Flux Measurements and Modelling" />
  
  <meta name="twitter:description" content="Fluxcourse Book" />
  

<meta name="author" content="Betsy Cowdery">


<meta name="date" content="2019-07-16">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="slides-and-videos.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview:</a></li>
<li class="chapter" data-level="2" data-path="before-the-course-reading-and-skills.html"><a href="before-the-course-reading-and-skills.html"><i class="fa fa-check"></i><b>2</b> Before the course : reading and skills</a><ul>
<li class="chapter" data-level="2.1" data-path="before-the-course-reading-and-skills.html"><a href="before-the-course-reading-and-skills.html#key-papers-on-the-eddy-flux"><i class="fa fa-check"></i><b>2.1</b> Key papers on the Eddy Flux</a></li>
<li class="chapter" data-level="2.2" data-path="before-the-course-reading-and-skills.html"><a href="before-the-course-reading-and-skills.html#photosynthesis-and-the-farquhar-von-caemmerer-berry-model"><i class="fa fa-check"></i><b>2.2</b> Photosynthesis and the Farquhar, von Caemmerer, Berry model</a></li>
<li class="chapter" data-level="2.3" data-path="before-the-course-reading-and-skills.html"><a href="before-the-course-reading-and-skills.html#linking-models-and-data"><i class="fa fa-check"></i><b>2.3</b> Linking models and data</a></li>
<li class="chapter" data-level="2.4" data-path="before-the-course-reading-and-skills.html"><a href="before-the-course-reading-and-skills.html#folderremote-sensing-of-gpp"><i class="fa fa-check"></i><b>2.4</b> FolderRemote Sensing of GPP</a></li>
<li class="chapter" data-level="2.5" data-path="before-the-course-reading-and-skills.html"><a href="before-the-course-reading-and-skills.html#a-primer-in-data-assimilation-using-mcmc"><i class="fa fa-check"></i><b>2.5</b> A primer in Data Assimilation using MCMC</a></li>
<li class="chapter" data-level="2.6" data-path="before-the-course-reading-and-skills.html"><a href="before-the-course-reading-and-skills.html#where-are-the-sources-and-sinks-of-carbon-around-the-globe"><i class="fa fa-check"></i><b>2.6</b> Where are the sources and sinks of Carbon around the globe?</a></li>
<li class="chapter" data-level="2.7" data-path="before-the-course-reading-and-skills.html"><a href="before-the-course-reading-and-skills.html#daves-gentle-introduction-to-matlab"><i class="fa fa-check"></i><b>2.7</b> <span>Dave’s gentle introduction to MATLAB</span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i><b>3</b> Schedule</a></li>
<li class="chapter" data-level="4" data-path="weekend.html"><a href="weekend.html"><i class="fa fa-check"></i><b>4</b> Weekend</a></li>
<li class="chapter" data-level="5" data-path="readings.html"><a href="readings.html"><i class="fa fa-check"></i><b>5</b> Readings</a><ul>
<li class="chapter" data-level="5.1" data-path="readings.html"><a href="readings.html#lecture-pdfs"><i class="fa fa-check"></i><b>5.1</b> Lecture PDFs</a></li>
<li class="chapter" data-level="5.2" data-path="readings.html"><a href="readings.html#gas-exchange"><i class="fa fa-check"></i><b>5.2</b> Gas Exchange</a></li>
<li class="chapter" data-level="5.3" data-path="readings.html"><a href="readings.html#photosynthesis-to-control-volume"><i class="fa fa-check"></i><b>5.3</b> Photosynthesis to control volume</a></li>
<li class="chapter" data-level="5.4" data-path="readings.html"><a href="readings.html#eddy-flux-instruments-and-data-uncertainty-organization"><i class="fa fa-check"></i><b>5.4</b> <strong>Eddy flux Instruments and data; uncertainty &amp; organization</strong></a></li>
<li class="chapter" data-level="5.5" data-path="readings.html"><a href="readings.html#asking-questions-with-flux-measurements---remote-sensing"><i class="fa fa-check"></i><b>5.5</b> <strong>Asking questions with flux measurements - Remote Sensing</strong></a></li>
<li class="chapter" data-level="5.6" data-path="readings.html"><a href="readings.html#intro-to-modeling"><i class="fa fa-check"></i><b>5.6</b> Intro to modeling</a></li>
<li class="chapter" data-level="5.7" data-path="readings.html"><a href="readings.html#combining-models-and-data"><i class="fa fa-check"></i><b>5.7</b> Combining models and data</a></li>
<li class="chapter" data-level="5.8" data-path="readings.html"><a href="readings.html#land-surface-modeling"><i class="fa fa-check"></i><b>5.8</b> Land surface modeling</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="slides-and-videos.html"><a href="slides-and-videos.html"><i class="fa fa-check"></i><b>6</b> Slides and Videos</a><ul>
<li class="chapter" data-level="6.1" data-path="slides-and-videos.html"><a href="slides-and-videos.html#section"><i class="fa fa-check"></i><b>6.1</b> 2012</a><ul>
<li class="chapter" data-level="6.1.1" data-path="slides-and-videos.html"><a href="slides-and-videos.html#pat-morgan-theory-of-leaf-level-gas-exchange-measurements-2012"><i class="fa fa-check"></i><b>6.1.1</b> Pat Morgan: <span>Theory of Leaf-Level Gas Exchange Measurements 2012</span></a></li>
<li class="chapter" data-level="6.1.2" data-path="slides-and-videos.html"><a href="slides-and-videos.html#carl-bernachhi-chloroplast-and-leaf-level-flux-modeling"><i class="fa fa-check"></i><b>6.1.2</b> Carl Bernachhi: <span>Chloroplast and Leaf-Level Flux Modeling</span></a></li>
<li class="chapter" data-level="6.1.3" data-path="slides-and-videos.html"><a href="slides-and-videos.html#paul-stoy-penman-monteith-leaves-to-canopies"><i class="fa fa-check"></i><b>6.1.3</b> Paul Stoy: <span>Penman-Monteith Leaves to Canopies</span></a></li>
<li class="chapter" data-level="6.1.4" data-path="slides-and-videos.html"><a href="slides-and-videos.html#russ-monson-infamous-stick-lecture"><i class="fa fa-check"></i><b>6.1.4</b> Russ Monson: <span>Infamous stick lecture</span></a></li>
<li class="chapter" data-level="6.1.5" data-path="slides-and-videos.html"><a href="slides-and-videos.html#larry-jacobsen-eddy-covariance-instrumentation"><i class="fa fa-check"></i><b>6.1.5</b> Larry Jacobsen: <span>Eddy Covariance Instrumentation</span></a></li>
<li class="chapter" data-level="6.1.6" data-path="slides-and-videos.html"><a href="slides-and-videos.html#george-burba-eddy-flux-instrumentation---gas-analyzers"><i class="fa fa-check"></i><b>6.1.6</b> George Burba: <span>Eddy Flux Instrumentation - Gas Analyzers</span></a></li>
<li class="chapter" data-level="6.1.7" data-path="slides-and-videos.html"><a href="slides-and-videos.html#marcy-litvak-fluxes-across-ecological-gradients-2012"><i class="fa fa-check"></i><b>6.1.7</b> Marcy Litvak: <span>Fluxes Across Ecological Gradients 2012</span></a></li>
<li class="chapter" data-level="6.1.8" data-path="slides-and-videos.html"><a href="slides-and-videos.html#dan-yakir-stable-isotopes-and-other-tracers-to-complement-flux-measurements"><i class="fa fa-check"></i><b>6.1.8</b> Dan Yakir: <span>Stable Isotopes and Other Tracers to Complement Flux Measurements</span></a></li>
<li class="chapter" data-level="6.1.9" data-path="slides-and-videos.html"><a href="slides-and-videos.html#dave-bowling-stable-carbon-isotopes-of-carbon-dioxide-in-ecosystem-science"><i class="fa fa-check"></i><b>6.1.9</b> Dave Bowling: <span>Stable Carbon Isotopes of Carbon Dioxide in Ecosystem Science</span></a></li>
<li class="chapter" data-level="6.1.10" data-path="slides-and-videos.html"><a href="slides-and-videos.html#dennis-baldocchi-integrating-information-on-biosphere-breathing-from-chloroplast-to-the-globe"><i class="fa fa-check"></i><b>6.1.10</b> Dennis Baldocchi: <span>Integrating Information on ‘Biosphere Breathing’ from Chloroplast to the Globe</span></a></li>
<li class="chapter" data-level="6.1.11" data-path="slides-and-videos.html"><a href="slides-and-videos.html#dave-moore-combining-models-with-data-models-validation-and-data-assimilation"><i class="fa fa-check"></i><b>6.1.11</b> Dave Moore: <span>Combining Models with Data: Models, Validation and Data Assimilation</span></a></li>
<li class="chapter" data-level="6.1.12" data-path="slides-and-videos.html"><a href="slides-and-videos.html#tristan-quaife-remote-sensing-for-carbon-cycle-science-2012"><i class="fa fa-check"></i><b>6.1.12</b> Tristan Quaife: <span>Remote Sensing for Carbon Cycle Science 2012</span></a></li>
<li class="chapter" data-level="6.1.13" data-path="slides-and-videos.html"><a href="slides-and-videos.html#john-zobitz-a-hitchhikers-guide-to-data-assimilation-in-the-ecological-sciences"><i class="fa fa-check"></i><b>6.1.13</b> John Zobitz: <span>A Hitchhiker’s Guide to Data Assimilation in the Ecological Sciences</span></a></li>
<li class="chapter" data-level="6.1.14" data-path="slides-and-videos.html"><a href="slides-and-videos.html#dave-moore-data-assimilation-using-ecosystem-models"><i class="fa fa-check"></i><b>6.1.14</b> Dave Moore: <span>Data Assimilation Using Ecosystem Models</span></a></li>
<li class="chapter" data-level="6.1.15" data-path="slides-and-videos.html"><a href="slides-and-videos.html#mike-dietz-ankur-desai-the-pecan-project-feedbacks-between-models-and-data"><i class="fa fa-check"></i><b>6.1.15</b> Mike Dietz &amp; Ankur Desai: <span>The PEcAn Project: Feedbacks Between Models and Data</span></a></li>
<li class="chapter" data-level="6.1.16" data-path="slides-and-videos.html"><a href="slides-and-videos.html#dave-schimel-chalk-talk-2012---the-global-carbon-cycle"><i class="fa fa-check"></i><b>6.1.16</b> Dave Schimel: <span>Chalk Talk 2012 - The Global Carbon Cycle</span></a></li>
<li class="chapter" data-level="6.1.17" data-path="slides-and-videos.html"><a href="slides-and-videos.html#deborah-huntzinger-regional-estimates-of-land-atmosphere-carbon-exchange"><i class="fa fa-check"></i><b>6.1.17</b> Deborah Huntzinger: <span>Regional Estimates of Land-Atmosphere Carbon Exchange</span></a></li>
<li class="chapter" data-level="6.1.18" data-path="slides-and-videos.html"><a href="slides-and-videos.html#rosie-fisher-the-representation-of-space-and-stochasticity-in-dynamic-global-vegetation-models"><i class="fa fa-check"></i><b>6.1.18</b> Rosie Fisher: <span>The Representation of Space and Stochasticity in Dynamic Global Vegetation Models</span></a></li>
<li class="chapter" data-level="6.1.19" data-path="slides-and-videos.html"><a href="slides-and-videos.html#andy-fox-informing-land-surface-models-with-data---scaling-from-sites-to-the-continent"><i class="fa fa-check"></i><b>6.1.19</b> Andy Fox: <span>Informing Land Surface Models with Data - Scaling from Sites to the Continent</span></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="slides-and-videos.html"><a href="slides-and-videos.html#section-1"><i class="fa fa-check"></i><b>6.2</b> 2013</a><ul>
<li class="chapter" data-level="6.2.1" data-path="slides-and-videos.html"><a href="slides-and-videos.html#diane-pataki-whats-the-big-deal-about-isotopes-anyway"><i class="fa fa-check"></i><b>6.2.1</b> Diane Pataki: <span>What’s the Big Deal About Isotopes Anyway?</span></a></li>
<li class="chapter" data-level="6.2.2" data-path="slides-and-videos.html"><a href="slides-and-videos.html#ray-leuning-introduction-to-measuring-fluxes-over-land-using-eddy-covariance"><i class="fa fa-check"></i><b>6.2.2</b> Ray Leuning: <span>Introduction To Measuring Fluxes Over Land Using Eddy Covariance</span></a></li>
<li class="chapter" data-level="6.2.3" data-path="slides-and-videos.html"><a href="slides-and-videos.html#dario-papale-when-collaboration-makes-the-difference-examples-from-fluxnet"><i class="fa fa-check"></i><b>6.2.3</b> Dario Papale: <span>When Collaboration Makes the Difference: Examples From FLUXNET</span></a></li>
<li class="chapter" data-level="6.2.4" data-path="slides-and-videos.html"><a href="slides-and-videos.html#ray-leuning-communicating-science-with-the-public"><i class="fa fa-check"></i><b>6.2.4</b> Ray Leuning: <span>Communicating Science with the Public</span></a></li>
<li class="chapter" data-level="6.2.5" data-path="slides-and-videos.html"><a href="slides-and-videos.html#russ-monson-eddy-flux-measurements-in-complex-terrain-the-ogre-in-the-closet"><i class="fa fa-check"></i><b>6.2.5</b> Russ Monson: <span>Eddy Flux Measurements in Complex Terrain: the Ogre in the Closet</span></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="slides-and-videos.html"><a href="slides-and-videos.html#section-2"><i class="fa fa-check"></i><b>6.3</b> 2015</a><ul>
<li class="chapter" data-level="6.3.1" data-path="slides-and-videos.html"><a href="slides-and-videos.html#andrew-leakey-measurement-analysis-and-interpretation-of-leaf-photosynthetic-gas-exchange"><i class="fa fa-check"></i><b>6.3.1</b> Andrew Leakey: <span>Measurement, analysis and interpretation of leaf photosynthetic gas exchange</span></a></li>
<li class="chapter" data-level="6.3.2" data-path="slides-and-videos.html"><a href="slides-and-videos.html#james-kathilankal-gas-analyzers-theory-and-maintenance-and-site-intercomparisons"><i class="fa fa-check"></i><b>6.3.2</b> James Kathilankal: <span>Gas Analyzers, Theory and Maintenance, and Site Intercomparisons</span></a></li>
<li class="chapter" data-level="6.3.3" data-path="slides-and-videos.html"><a href="slides-and-videos.html#kim-novick-energy-balance-and-evapotanspiration"><i class="fa fa-check"></i><b>6.3.3</b> Kim Novick: <span>Energy Balance and Evapotanspiration</span></a></li>
<li class="chapter" data-level="6.3.4" data-path="slides-and-videos.html"><a href="slides-and-videos.html#russ-monson-c4-photosynthesis-a-historical-perspective-and-associated-general-lessons-in-science"><i class="fa fa-check"></i><b>6.3.4</b> Russ Monson: <span>C4 Photosynthesis: A Historical Perspective and Associated General Lessons in Science</span></a></li>
<li class="chapter" data-level="6.3.5" data-path="slides-and-videos.html"><a href="slides-and-videos.html#pat-morgan-theory-of-leaf-level-gas-exchange-measurements-2015"><i class="fa fa-check"></i><b>6.3.5</b> Pat Morgan: <span>Theory of Leaf-Level Gas Exchange Measurements 2015</span></a></li>
<li class="chapter" data-level="6.3.6" data-path="slides-and-videos.html"><a href="slides-and-videos.html#ankur-desai-you-have-nee-now-what"><i class="fa fa-check"></i><b>6.3.6</b> Ankur Desai: <span>You have NEE: Now what?</span></a></li>
<li class="chapter" data-level="6.3.7" data-path="slides-and-videos.html"><a href="slides-and-videos.html#marcy-litvak-fluxes-across-ecological-gradients-2015"><i class="fa fa-check"></i><b>6.3.7</b> Marcy Litvak: <span>Fluxes Across Ecological Gradients 2015</span></a></li>
<li class="chapter" data-level="6.3.8" data-path="slides-and-videos.html"><a href="slides-and-videos.html#ed-swiatek-eddy-covariance-instrumentation"><i class="fa fa-check"></i><b>6.3.8</b> Ed Swiatek: <span>Eddy Covariance Instrumentation</span></a></li>
<li class="chapter" data-level="6.3.9" data-path="slides-and-videos.html"><a href="slides-and-videos.html#tristan-quaife-remote-sensing-for-carbon-cycle-science-2015"><i class="fa fa-check"></i><b>6.3.9</b> Tristan Quaife: <span>Remote Sensing for Carbon Cycle Science 2015</span></a></li>
<li class="chapter" data-level="6.3.10" data-path="slides-and-videos.html"><a href="slides-and-videos.html#russ-monson-the-eddy-flux"><i class="fa fa-check"></i><b>6.3.10</b> Russ Monson: <span>The Eddy Flux</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>7</b> Exercises</a><ul>
<li class="chapter" data-level="7.1" data-path="exercises.html"><a href="exercises.html#fitting-ac-ci-curves"><i class="fa fa-check"></i><b>7.1</b> Fitting Ac-Ci Curves</a><ul>
<li class="chapter" data-level="7.1.1" data-path="exercises.html"><a href="exercises.html#setup"><i class="fa fa-check"></i><b>7.1.1</b> Setup</a></li>
<li class="chapter" data-level="7.1.2" data-path="exercises.html"><a href="exercises.html#loading-data"><i class="fa fa-check"></i><b>7.1.2</b> Loading data</a></li>
<li class="chapter" data-level="7.1.3" data-path="exercises.html"><a href="exercises.html#qaqc-checks"><i class="fa fa-check"></i><b>7.1.3</b> QA/QC Checks</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="exercises.html"><a href="exercises.html#stomatal-conductance-modeling-exercise"><i class="fa fa-check"></i><b>7.2</b> Stomatal Conductance Modeling Exercise:</a><ul>
<li class="chapter" data-level="7.2.1" data-path="exercises.html"><a href="exercises.html#leuning"><i class="fa fa-check"></i><b>7.2.1</b> Leuning</a></li>
<li class="chapter" data-level="7.2.2" data-path="exercises.html"><a href="exercises.html#hydraulic-model"><i class="fa fa-check"></i><b>7.2.2</b> Hydraulic Model</a></li>
<li class="chapter" data-level="7.2.3" data-path="exercises.html"><a href="exercises.html#optimality-model"><i class="fa fa-check"></i><b>7.2.3</b> Optimality Model</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Annual Summer Course in Flux Measurements and Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercises" class="section level1">
<h1><span class="header-section-number">7</span> Exercises</h1>

<div id="fitting-ac-ci-curves" class="section level2">
<h2><span class="header-section-number">7.1</span> Fitting Ac-Ci Curves</h2>
<p>We are going to follow along with a Vignette that explains how to fit response curves using R</p>
<p>We’ll use PEcAn - you’ll use PEcAn next week to do some data assimilation</p>
<p>We will also look at another package written by Duursma</p>
<div id="setup" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Setup</h3>
<div id="jags" class="section level4">
<h4><span class="header-section-number">7.1.1.1</span> JAGS</h4>
<p>JAGS is a program for analysis of Bayesian hierarchical models</p>
<p>To install go to <a href="https://sourceforge.net/projects/mcmc-jags/files/JAGS/4.x/" class="uri">https://sourceforge.net/projects/mcmc-jags/files/JAGS/4.x/</a> and select the version appropriate for your operating system.</p>
<p>There may be a link pointing directly to the newest version so you don’t have to look through the file structure.</p>
<p><img src="/assets/Screen%20Shot%202017-07-11%20at%2011.45.58%20AM.png" /></p>
</div>
<div id="the-pecan-photosynthesis-package" class="section level4">
<h4><span class="header-section-number">7.1.1.2</span> The PEcAn Photosynthesis Package</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">##### Required for PEcAN</span>

<span class="co"># install packages</span>

<span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)

<span class="kw">install.packages</span>(<span class="st">&quot;rjags&quot;</span>)

<span class="co"># load the packages</span>

<span class="kw">library</span>(devtools)

<span class="kw">library</span>(rjags)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Next Install PEcAN.photosynthesis ... this is not available through CRAN</span>
<span class="co"># - but you can find it on GITHUB - this code will download and install</span>

<span class="co">### This step might take a while</span>

<span class="co">#if (!require(&quot;PEcAn.photosynthesis&quot;, character.only = TRUE)) {</span>
devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;PecanProject/pecan/modules/photosynthesis&quot;</span>, 
                         <span class="dt">ref =</span> <span class="st">&quot;release/1.5.0&quot;</span>)
<span class="co">#}</span>

knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">cache =</span> <span class="ot">TRUE</span>)

<span class="kw">library</span>(PEcAn.photosynthesis)</code></pre>
</div>
<div id="the-plantecophys-package" class="section level4">
<h4><span class="header-section-number">7.1.1.3</span> The plantecophys package</h4>
<ul>
<li>Modelling and Analysis of Leaf Gas Exchange Data</li>
<li>Coupled leaf gas exchange model, A-Ci curve simulation and fitting,</li>
<li>Ball-Berry stomatal conductance models, leaf energy balance using Penman-Monteith,</li>
<li>Cowan-Farquhar optimization, humidity unit conversions.</li>
</ul>
<p><a href="https://cran.r-project.org/web/packages/plantecophys/index.html">https://cran.r-project.org/web/packages/plantecophys/index.html</a></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># IN CASE YOU JUST ABOLUTELY HAVE TO HAVE THE LATEST VERSION</span>
<span class="co">#  i nstall_bitbucket(&quot;remkoduursma/plantecophys&quot;)</span>
<span class="co"># install the package</span>

<span class="kw">install.packages</span>(<span class="st">&quot;plantecophys&quot;</span>)

<span class="co"># load the package</span>
<span class="kw">library</span> (plantecophys)

<span class="co"># REFERENCE MANUAL </span>
https<span class="op">:</span><span class="er">//</span>cran.r<span class="op">-</span>project.org<span class="op">/</span>web<span class="op">/</span>packages<span class="op">/</span>plantecophys<span class="op">/</span>plantecophys.pdf

<span class="co"># Some utility packages# if you need to install ... then install them :)</span>

<span class="co"># install.packages(&quot;dplyr&quot;)</span>
<span class="kw">library</span>(dplyr)

<span class="co"># install.packages(&quot;tidyr&quot;)</span>
<span class="kw">library</span>(tidyr)

<span class="co"># install.packages(&quot;ggplot2&quot;)</span>
<span class="kw">library</span>(ggplot2)

<span class="co"># install.packages(&quot;grid&quot;)</span>
<span class="kw">library</span>(grid) <span class="co">#required for &#39;unit&#39;</span></code></pre>
</div>
</div>
<div id="loading-data" class="section level3">
<h3><span class="header-section-number">7.1.2</span> Loading data</h3>
<div id="using-pre-loaded-data" class="section level4">
<h4><span class="header-section-number">7.1.2.1</span> Using pre-loaded data</h4>
<p>With the PEcAn Photosynthesis package, you have downloaded the LICOR files collected by the FLUXCOURSE in 2012.</p>
<p>If you want to see the files you can go into your R directory on your computer and you can find it in the extdata folder within the PEcAN.photosynthesis package.</p>
<p>For example : <code>C:\Users\dmoore\Documents\R\R-3.4.0\library\PEcAn.photosynthesis\extdata</code></p>
<p>The command system.file()` in R allows you to call up folders relevant to a particular package. This commant looks in the folder, scans for files with aci or aq in the filename and writes these names <span class="math inline">\(and their full path\)</span> to the R object “filenames”.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## Get list of LI-COR 6400 file names (ASCII not xls)</span>
filenames &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="kw">paste0</span>(<span class="st">&quot;flux-course-&quot;</span>,<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,<span class="dt">each=</span><span class="dv">2</span>),<span class="kw">c</span>(<span class="st">&quot;aci&quot;</span>,<span class="st">&quot;aq&quot;</span>)), <span class="dt">package =</span> <span class="st">&quot;PEcAn.photosynthesis&quot;</span>)

<span class="co"># filenames is 12 character variables</span>
<span class="co"># These files are licor files ... not CSV files, not XLSX files</span>
<span class="co"># ... just the file that comes right off the machine ... it has no file extension</span>

<span class="co"># PEcAN.photosynthesis contains a command call read.licor() ...I bet you can guess what it does!</span>
<span class="co"># read.Licor will load an individual licor file ... if you have one.</span>

<span class="co">## Load files to a list</span>
master =<span class="st"> </span><span class="kw">lapply</span>(filenames, read_Licor)</code></pre>
</div>
<div id="using-your-own-data" class="section level4">
<h4><span class="header-section-number">7.1.2.2</span> Using your own data</h4>
<p>You can download this year’s data as a ZIP file at <a href="https://github.com/Fluxcourse/2017_LI-COR">https://github.com/Fluxcourse/2017_LI-COR</a></p>
<p><img src="/assets/Screen%20Shot%202017-07-11%20at%2012.29.31%20AM.png" /></p>
<p>You can do the same process with your own data …. you just need to point R to those data and load em up into a big list.</p>
<pre class="sourceCode r"><code class="sourceCode r">my_data &lt;-<span class="st"> &quot;path_to_your_data&quot;</span> 
<span class="co"># for example: my_data &lt;- &quot;~/Downloads/2017_LI-COR-master/07102017PSC0365_CO2response&quot;</span>

master =<span class="st"> </span><span class="kw">read_Licor</span>(my_data)</code></pre>
</div>
</div>
<div id="qaqc-checks" class="section level3">
<h3><span class="header-section-number">7.1.3</span> QA/QC Checks</h3>
<p>The code below performs a set of interactive QA/QC checks on the LI-COR data that’s been loaded.</p>
<pre class="sourceCode r"><code class="sourceCode r">master[[<span class="dv">1</span>]] &lt;-<span class="st"> </span><span class="kw">Licor_QC</span>(master[[<span class="dv">1</span>]])</code></pre>
<p>If you have more than one file loaded into the `master` list, you may only want to run the function for one file, rather than looping over all the files.</p>
<pre class="sourceCode r"><code class="sourceCode r">master[[<span class="dv">1</span>]] &lt;-<span class="st"> </span><span class="kw">Licor_QC</span>(master[[<span class="dv">1</span>]])</code></pre>

</div>
</div>
<div id="stomatal-conductance-modeling-exercise" class="section level2">
<h2><span class="header-section-number">7.2</span> Stomatal Conductance Modeling Exercise:</h2>
<p>Below is a dataset containing meteorological observations and tower-derived GPP estimates collected at MMSF during the course of a severe drought occurring in 2012.</p>
<p>The data can be downloaded <a href="https://raw.githubusercontent.com/Fluxcourse/Lecture_materials/master/Stomatal%20Conductance/FluxCourse_GSmodeling%201.txt?raw=true" title="here">here</a></p>
<pre><code>DOY    Hour    VPD (kPa)    SWP (Mpa)    VWC (m3/m3)    Par (umol/m2/s)    CO2 (ppm)    GPP (umol/m2/s)    
161.00    13.00    1.78    -0.31    24.16    1581.51    378.88    31.17    
162.00    13.00    0.81    -0.40    22.18    1039.02    393.49    26.87    
163.00    13.00    2.19    -0.35    23.29    1981.02    391.32    14.06    
164.00    13.00    1.65    -0.37    22.79    1959.24    390.29    28.01    
165.00    13.00    2.28    -0.40    22.08    1975.11    386.57    21.81    
166.00    13.00    2.61    -0.43    21.51    1964.63    388.04    17.56    
167.00    13.00    2.32    -0.46    21.06    1921.93    384.74    20.38    
168.00    13.00    1.34    -0.49    20.65    1620.87    392.81    20.75    
169.00    13.00    2.08    -0.53    20.05    1912.18    385.83    22.01    
170.00    13.00    2.28    -0.57    19.51    1942.83    389.73    19.74    
171.00    13.00    2.51    -0.63    18.85    1817.14    390.25    19.51    
172.00    13.00    2.51    -0.67    18.37    1718.25    388.63    20.61    
173.00    13.00    2.37    -0.71    17.99    2004.02    390.08    17.98    
174.00    13.00    2.53    -0.76    17.61    1597.01    384.12    26.28    
175.00    13.00    2.72    -0.80    17.27    1151.81    382.42    22.52    
176.00    13.00    2.40    -0.86    16.83    1974.86    389.35    17.76    
177.00    13.00    2.02    -0.90    16.54    1992.69    389.01    12.18    
178.00    13.00    2.58    -0.96    16.12    1976.11    386.41    16.60    
179.00    13.00    3.77    -1.03    15.74    1945.17    386.67    7.43    
180.00    13.00    3.20    -1.08    15.48    1858.93    386.64    16.02    
181.00    13.00    3.29    -1.12    15.26    1815.67    389.95    12.42    
182.00    13.00    2.84    -1.15    15.00    1679.99    394.88    19.59    
183.00    13.00    2.91    -1.21    14.83    1743.00    393.03    19.10    
184.00    13.00    2.42    -1.24    14.66    1782.24    395.40    20.37    
185.00    13.00    3.41    -1.29    14.47    1846.70    399.83    12.69    
186.00    13.00    4.39    -1.34    14.26    1653.94    397.45    11.65    
187.00    13.00    4.14    -1.38    14.09    1599.68    392.84    8.08    
188.00    13.00    4.19    -1.41    13.99    726.34    392.89    7.05    
189.00    13.00    2.08    -1.41    14.00    183.91    402.59    NaN    
190.00    13.00    2.65    -1.45    13.84    1751.20    383.80    17.21    
191.00    13.00    3.23    -1.51    13.64    1964.57    385.53    13.61    
192.00    13.00    3.03    -1.54    13.54    2000.73    384.07    16.73    
193.00    13.00    3.13    -1.59    13.37    1614.61    384.63    11.51    
194.00    13.00    1.91    -1.60    13.35    1801.13    396.36    23.55    
195.00    13.00    0.89    -1.58    13.40    1973.77    404.49    21.15    
196.00    13.00    1.96    -1.62    13.29    1807.26    398.74    14.46    
197.00    13.00    2.14    -1.65    13.19    832.07    400.72    9.93    
198.00    13.00    2.52    -1.70    13.05    1703.59    398.55    12.63    
199.00    13.00    2.94    -1.70    13.04    1531.01    397.72    11.89</code></pre>
<p>For the purposes of this exercise, the data are limited to midday <span class="math inline">\(i.e. hour 1300\)</span> values. Use the data to generate estimates of stomatal conductance using the Leuning model, and plant hydraulic model, and the Medlyn optimality model. As a reminder, here are the model forms, and some suggested parameter values.</p>
<p>Use the data to generate estimates of stomatal conductance using the Leuning model, and plant hydraulic model, and the Medlyn optimality model. As a reminder, here are the model forms, and some suggested parameter values:</p>
<div id="leuning" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Leuning</h3>
<p><span class="math display">\[ g_s = \frac{m_2 A}{s_s - \Gamma}(1 + \frac{D}{D_o})^{-1} + b_2 \]</span></p>
<p>Let:</p>
<p><span class="math display">\[D_o\]</span> = 1.1 kPa</p>
<p><span class="math display">\[b_2\]</span> = .001 mol/m2/s</p>
<p><span class="math display">\[m_2\]</span> = 6.5 dimensionless</p>
<p><span class="math display">\[\Gamma\]</span> = 50 ppm</p>
</div>
<div id="hydraulic-model" class="section level3">
<h3><span class="header-section-number">7.2.2</span> Hydraulic Model</h3>
<p><span class="math display">\[g_s = \frac{K(\Psi_s - \Psi_L -pgh)}{VPD}\]</span></p>
<p>Let:</p>
<p><span class="math display">\[K\]</span> = 0.3 mol/m2/s</p>
<p><span class="math display">\[pgh\]</span> = 0.3 <span class="math inline">\(appropriate for a 30-m-tall tree\)</span></p>
<p>Assume:</p>
<p>constant <span class="math display">\[\Psi_L\]</span> = -1.8 MPa <span class="math inline">\(isohydric species\)</span></p>
</div>
<div id="optimality-model" class="section level3">
<h3><span class="header-section-number">7.2.3</span> Optimality Model</h3>
<p><span class="math display">\[g_s^* \approx g_0 + 1.6(1+ \frac{g_1}{\sqrt{D}})\frac{A}{C_a}\]</span></p>
<p>Let:</p>
<p><span class="math display">\[g_0\]</span> = .001 mol/m2/s</p>
<p><span class="math display">\[g_1\]</span> = 2</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="slides-and-videos.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
